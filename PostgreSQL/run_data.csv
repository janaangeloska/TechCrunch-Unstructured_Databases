"query_number","userid","dbname","query","calls","rows","mean_rows","total_exec_time_ms","min_exec_time_ms","max_exec_time_ms","mean_exec_time_ms","stddev_exec_time_ms"
1,"admin","NbNP","SELECT -- 1. Find all posts authored by ""Jason Kincaid""
	P.POST_ID,
	P.TITLE,
	P.DATE
FROM
	POSTS AS P
	INNER JOIN AUTHORS AS A ON P.BLOGGERS_ID = A.AUTH_ID
WHERE
	A.""name"" = $1
ORDER BY
	P.DATE DESC","30","54630","1821","161.78","4.66","6.98","5.39","0.74"
2,"admin","NbNP","SELECT -- 2. Find bloggers who have published posts after ""2010-01-01""
	A.""name"",
	COUNT(P.POST_ID) AS ""posts_after_2010""
FROM
	POSTS AS P
	INNER JOIN AUTHORS AS A ON P.BLOGGERS_ID = A.AUTH_ID
WHERE
	P.DATE > $1
GROUP BY
	A.""name""
ORDER BY
	POSTS_AFTER_2010 DESC","30","1230","41","171.25","5.12","7.11","5.71","0.54"
3,"admin","NbNP","SELECT -- 3. Find posts that have more than 50 comments
	P.TITLE,
	COUNT(C.COM_ID) AS ""total_comments""
FROM
	""comments"" AS C
	INNER JOIN POSTS AS P ON C.POST_ID = P.POST_ID
GROUP BY
	P.TITLE
ORDER BY
	TOTAL_COMMENTS DESC","30","566880","18896","3924.94","117.67","154.73","130.83","9.97"
4,"admin","NbNP","WITH -- 4. (With CTE)  For each blogger, find the total number of comments and inlinks on their posts
	TOTAL_COMMENTS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(C.COM_ID) AS TOTAL_COMMENTS
		FROM
			POSTS AS P
			LEFT JOIN ""comments"" AS C ON C.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	),
	TOTAL_INLINKS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(I.INL_ID) AS TOTAL_INLINKS
		FROM
			POSTS AS P
			LEFT JOIN INLINKS AS I ON I.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	)
SELECT
	A.""name"",
	TOTAL_COMMENTS,
	TOTAL_INLINKS
FROM
	AUTHORS A
	LEFT JOIN TOTAL_INLINKS AS TI ON TI.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTAL_COMMENTS AS TC ON TC.BLOGGERS_ID = A.AUTH_ID
ORDER BY
	TOTAL_INLINKS DESC,
	TOTAL_COMMENTS DESC","30","3210","107","6097.53","188.46","250.08","203.25","12.69"
4,"admin","NbNP","SELECT -- 4. (With not normalised values)  For each blogger, find the total number of comments and inlinks on their posts
	A.""name"" AS AUTHOR_NAME,
	-- P.POST_ID,
	SUM(P.NR_RETRIVED_COMMENTS) AS TOTAL_COMMENTS,
	SUM(P.NR_RETRIVED_INLINKS) AS TOTAL_INLINKS
FROM
	AUTHORS AS A
	LEFT JOIN POSTS AS P ON P.BLOGGERS_ID = A.AUTH_ID
	-- WHERE A.""name"" = 'Robin Wauters'
GROUP BY
	-- P.POST_ID
	A.""name""
ORDER BY
	TOTAL_INLINKS DESC,
	TOTAL_COMMENTS DESC","30","3210","107","296.87","9.17","12.99","9.90","0.83"
5,"admin","NbNP","WITH -- 5. Identify the most influential bloggers based on the average number of inlinks per post
	TOTAL_INLINKS_POST AS (
		SELECT
			P.POST_ID,
			COUNT(I.INL_ID) AS TOTAL_INLINKS_POST
		FROM
			POSTS AS P
			LEFT JOIN INLINKS AS I ON I.POST_ID = P.POST_ID
		GROUP BY
			P.POST_ID
	)
SELECT
	A.""name"" AS BLOGGER_NAME,
	COUNT(P.POST_ID) AS TOTAL_POSTS,
	SUM(TI.TOTAL_INLINKS_POST) AS TOTAL_INLINKS,
	SUM(TI.TOTAL_INLINKS_POST) / COUNT(P.POST_ID) AS AVG_INLINKS_PER_POST
FROM
	AUTHORS AS A
	LEFT JOIN POSTS AS P ON P.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTAL_INLINKS_POST AS TI ON TI.POST_ID = P.POST_ID
GROUP BY
	A.""name""
ORDER BY
	TOTAL_INLINKS DESC,
	AVG_INLINKS_PER_POST DESC","30","3210","107","6790.77","201.68","285.49","226.36","18.15"
6,"admin","NbNP","SELECT -- 6. Find the first 100 most commented posts along with their authors
    A.""name"" AS author_name,
    P.title AS post_title,
    COUNT(C.COM_ID) AS comment_count
FROM 
 	POSTS AS P          
	INNER JOIN AUTHORS AS A ON P.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN ""comments"" AS C ON C.POST_ID = P.POST_ID
GROUP BY 
	P.title, A.""name""
ORDER BY 
	comment_count DESC
LIMIT $1","30","3000","100","10393.12","318.23","380.77","346.44","16.65"
7,"admin","NbNP","WITH -- 7. Calculate the average number of comments and inlinks per post for each blogger
	TOTAL_INLINKS_POST AS (
		SELECT
			P.POST_ID,
			COUNT(I.INL_ID) AS TOTAL_INLINKS_POST
		FROM
			POSTS AS P
			LEFT JOIN INLINKS AS I ON I.POST_ID = P.POST_ID
		GROUP BY
			P.POST_ID
	),
	TOTAL_COMMENTS_POST AS (
		SELECT
			P.POST_ID,
			COUNT(C.COM_ID) AS TOTAL_COMMENTS_POST
		FROM
			POSTS AS P
			LEFT JOIN ""comments"" AS C ON C.POST_ID = P.POST_ID
		GROUP BY
			P.POST_ID
	)
SELECT
	A.""name"" AS BLOGGER_NAME,
	COUNT(P.POST_ID) AS TOTAL_POSTS,
	SUM(TI.TOTAL_INLINKS_POST) AS TOTAL_INLINKS,
	SUM(TC.TOTAL_COMMENTS_POST) AS TOTAL_COMMENTS,
	SUM(TI.TOTAL_INLINKS_POST) / COUNT(P.POST_ID) AS AVG_INLINKS_PER_POST,
	SUM(TC.TOTAL_COMMENTS_POST) / COUNT(P.POST_ID) AS AVG_COMMENTS_PER_POST
FROM
	AUTHORS AS A
	LEFT JOIN POSTS AS P ON P.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTAL_INLINKS_POST AS TI ON TI.POST_ID = P.POST_ID
	LEFT JOIN TOTAL_COMMENTS_POST AS TC ON TC.POST_ID = P.POST_ID
GROUP BY
	A.""name""
ORDER BY
	AVG_INLINKS_PER_POST DESC,
	AVG_COMMENTS_PER_POST DESC","30","3210","107","13288.82","392.99","521.74","442.96","23.46"
8,"admin","NbNP","WITH -- 8. Identify the most influential bloggers by aggregating MEIBI and MEIBIX scores across their posts

	TOTAL_COMMENTS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(C.COM_ID) AS TOTAL_COMMENTS
		FROM
			POSTS AS P
			LEFT JOIN ""comments"" AS C ON C.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	),
	TOTAL_INLINKS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(I.INL_ID) AS TOTAL_INLINKS
		FROM
			POSTS AS P
			LEFT JOIN INLINKS AS I ON I.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	),
	TOTALS_POST AS (
		SELECT
			P.BLOGGERS_ID,
			SUM(P.MEIBI_SCORE) AS TOTAL_MEIBI,
			SUM(P.MEIBIX_SCORE) AS TOTAL_MEIBIX
		FROM
			POSTS AS P
		GROUP BY
			P.BLOGGERS_ID
	)
SELECT
	A.""name"",
	TOTAL_MEIBI,
	TOTAL_MEIBIX,
	TOTAL_COMMENTS,
	TOTAL_INLINKS,
	TOTAL_MEIBI + TOTAL_MEIBIX + TOTAL_COMMENTS + TOTAL_INLINKS AS TOTAL_INFLUENCE
FROM
	AUTHORS A
	LEFT JOIN TOTAL_INLINKS AS TI ON TI.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTAL_COMMENTS AS TC ON TC.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTALS_POST AS TP ON TP.BLOGGERS_ID = A.AUTH_ID
ORDER BY
	TOTAL_INFLUENCE DESC","30","3210","107","5973.71","181.24","232.37","199.12","12.37"
9,"admin","NbNP","WITH -- 9. Find the first 100 posts with the highest engagement score (sum of comments and inlinks)
	TOTAL_COMMENTS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(C.COM_ID) AS TOTAL_COMMENTS
		FROM
			POSTS AS P
			LEFT JOIN ""comments"" AS C ON C.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	),
	TOTAL_INLINKS AS (
		SELECT
			P.BLOGGERS_ID,
			COUNT(I.INL_ID) AS TOTAL_INLINKS
		FROM
			POSTS AS P
			LEFT JOIN INLINKS AS I ON I.POST_ID = P.POST_ID
		GROUP BY
			P.BLOGGERS_ID
	)
SELECT
	A.""name"",
	TOTAL_COMMENTS,
	TOTAL_INLINKS,
	TOTAL_COMMENTS + TOTAL_INLINKS AS ENGAGEMENT_SCORE
FROM
	AUTHORS A
	LEFT JOIN TOTAL_INLINKS AS TI ON TI.BLOGGERS_ID = A.AUTH_ID
	LEFT JOIN TOTAL_COMMENTS AS TC ON TC.BLOGGERS_ID = A.AUTH_ID
ORDER BY
	ENGAGEMENT_SCORE DESC
LIMIT $1","30","3000","100","5785.64","172.51","239.49","192.85","13.47"
